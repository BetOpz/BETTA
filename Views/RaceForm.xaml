<Window x:Class="BETTA.Views.RaceForm"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Race Details"
        Height="600"
        Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#F8F8F8"
        FontFamily="Segoe UI">

    <Window.Resources>
        <!-- Define the styles BEFORE they are used -->
        <Style x:Key="CenterTextStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="RightTextStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>
        <!-- Centered column header style -->
        <Style x:Key="CenterHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <DockPanel>
        <!-- Race Header -->
        <Border DockPanel.Dock="Top"
                Background="#007ACC"
                Padding="20,15">
            <StackPanel>
                <TextBlock x:Name="RaceTitle"
                           Foreground="White"
                           FontSize="20"
                           FontWeight="Bold"
                           Text="Loading race details..."/>
                <TextBlock x:Name="RaceSubtitle"
                           Foreground="White"
                           FontSize="14"
                           Margin="0,5,0,0"
                           Text="Market information will appear here"/>
            </StackPanel>
        </Border>

        <!-- Status/Loading Bar -->
        <Border DockPanel.Dock="Top"
                Background="#E8E8E8"
                BorderThickness="0,0,0,1"
                BorderBrush="#CCC"
                Padding="20,10">
            <TextBlock x:Name="StatusText"
                       FontSize="12"
                       Foreground="#666"
                       Text="Loading market data..."/>
        </Border>

        <!-- Action Buttons -->
        <Border DockPanel.Dock="Bottom"
                Background="White"
                BorderThickness="0,1,0,0"
                BorderBrush="#CCC"
                Padding="20,15">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="BtnRefresh"
                        Content="Refresh Odds"
                        Click="BtnRefresh_Click"
                        Padding="15,8"
                        Background="#007ACC"
                        Foreground="White"
                        BorderThickness="0"
                        Margin="0,0,10,0"/>
                <Button x:Name="BtnClose"
                        Content="Close"
                        Click="BtnClose_Click"
                        Padding="15,8"
                        Background="#666"
                        Foreground="White"
                        BorderThickness="0"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <DockPanel Margin="20">

            <!-- Book% Totals Summary Row -->
            <Border DockPanel.Dock="Bottom"
                    Background="#F0F0F0"
                    BorderThickness="1"
                    BorderBrush="#CCC"
                    Padding="0"
                    Margin="0,10,0,0">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <!-- P/L -->
                        <ColumnDefinition Width="3*"/>
                        <!-- Horse -->
                        <ColumnDefinition Width="*"/>
                        <!-- Back Price -->
                        <ColumnDefinition Width="*"/>
                        <!-- Lay Price -->
                        <ColumnDefinition Width="*"/>
                        <!-- Last Traded -->
                        <ColumnDefinition Width="*"/>
                        <!-- Optimum -->
                        <ColumnDefinition Width="*"/>
                        <!-- Bets -->
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" Padding="8"/>

                    <TextBlock Grid.Column="1" Text="BOOK %" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" FontSize="14" Padding="8"/>

                    <TextBlock Grid.Column="2" x:Name="BackBookPercent" Text="0.0%" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" FontSize="13" Padding="8"
                               Foreground="DarkBlue"/>

                    <TextBlock Grid.Column="3" x:Name="LayBookPercent" Text="0.0%" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" FontSize="13" Padding="8"
                               Foreground="DarkRed"/>

                    <TextBlock Grid.Column="4" x:Name="LastBookPercent" Text="0.0%" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" FontSize="13" Padding="8"
                               Foreground="DarkGreen"/>

                    <TextBlock Grid.Column="5" x:Name="OptimumBookPercent" Text="N/A" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" FontSize="13" Padding="8"
                               Foreground="Purple"/>

                    <TextBlock Grid.Column="6" Text="" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontWeight="Bold" Padding="8"/>
                </Grid>
            </Border>

            <!-- Runners List -->
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <DataGrid x:Name="RunnersGrid"
                          AutoGenerateColumns="False"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          RowHeaderWidth="0"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False"
                          CanUserResizeRows="False"
                          CanUserSortColumns="True"
                          IsReadOnly="True"
                          AlternatingRowBackground="#F9F9F9">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="P/L"
                                            Binding="{Binding profit_loss}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Horse"
                                            Binding="{Binding name}"
                                            Width="3*"
                                            FontWeight="SemiBold"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Back Price"
                                            Binding="{Binding back_price, StringFormat='{}{0:F2}'}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Lay Price"
                                            Binding="{Binding lay_price, StringFormat='{}{0:F2}'}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Last Traded"
                                            Binding="{Binding last_price_traded, StringFormat='{}{0:F2}'}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Optimum"
                                            Binding="{Binding optimum}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                        <DataGridTextColumn Header="Bets"
                                            Binding="{Binding bets}"
                                            Width="*"
                                            ElementStyle="{StaticResource CenterTextStyle}"
                                            HeaderStyle="{StaticResource CenterHeaderStyle}"/>
                    </DataGrid.Columns>

                </DataGrid>
            </ScrollViewer>
        </DockPanel>
    </DockPanel>
</Window>
